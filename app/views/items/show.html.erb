
<!-- this is the display for merchandise  -->
<div class="row">
  <div class="com-md-12">
    <h1><%= @item.name %></h1>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
      <img class="img-responsive" src="<%= @item.image %>">
  </div>

  <div class="col-md-6">
    <div class="text-center">
      <h4>$<%= @item.price %></h4>

      <h4><%= @item.description %></h4>
      <h4><%= @item.carts.where(:paid => true).count %> Sold</h4>

      <% if @item.required == true %>
        <h4> Required For Members</h4>
        <% if current_user.paid_items.include?(@item) %>
        <% else %>
          <h4>Purchase by <%= @item.expiration_date.strftime("%A %B %d, %Y")  %></h4>
        <% end %>
          <%= link_to "View Report", "/view_report/#{@item.id}" %>
          <br>
      <% else %>
         <h4>Purchase by <%= @item.expiration_date.strftime("%A %B %d, %Y")  %></h4>
      <% end %>

      <% if @item.color_options.count > 1 %>
      <div class="col-md-offset-4 col-md-4">
        <%= select_tag("color_option", options_from_collection_for_select(ColorOption.where(:item_id => @item.id), :id, :color), {class: "form-control", prompt: "Select a color"}) %>
        <br>
      </div>

      <% end %>

      <% if @item.size_options.count > 1 %>
        <div class="col-md-offset-4 col-md-4">
        <%= select_tag("size_option", options_from_collection_for_select(SizeOption.where(:item_id => @item.id), :id, :size), {prompt: "Select a Size", class: "form-control"}) %>
        <br>
        </div>

      <% end %>


      <div class="col-md-offset-4 col-md-4">
        <% if current_user.items_in_cart.include?(@item) %>
          <%= render "items/remove_from_cart_button", :item => @item, :cart => @cart %>
        <% else %>
          <%= render "items/add_to_cart_button", :item => @item, :cart => @cart %>
        <% end %>
      </div>
      <div class="col-md-offset-4 col-md-4">
      <% if current_user.items_in_cart.include?(@item) %>
        <%= link_to "View My Cart", my_cart_url %>
      <% end %>
      </div>
    </div>
  </div>
</div>
<br>
<br>
<div class="row">
  <div class="col-md-12">
    <p class="lead"><%= link_to "#{@item.university.name}", university_url(@item.university) %> <i class="fa fa-chevron-right"></i> <%= link_to "#{@item.club.name}", university_url(@item.club) %> <i class="fa fa-chevron-right"></i> <%= @item.name %></p>
  </div>
</div>

<% if current_user == @item.owner %>
  <div class="row">
    <%= link_to 'Edit', edit_item_path(@item) %> |
    <%= link_to 'Destroy', item_url(@item), method: :delete, data: { confirm: 'Are you sure?' } %>
  </div>
<% end %>


<script type="text/javascript">
  $("#add_to_cart_<%= @item.id %>").click(function(event){
    var color_options = document.getElementById("color_option");
    var color_option = color_options.options[color_options.selectedIndex].value;

    var size_options = document.getElementById("size_option");
    var size_option = size_options.options[size_options.selectedIndex].value;

    if ( color_option == '') {
      alert("Please select a color");
      event.preventDefault();
      event.stopPropagation();

    } else {
      console.log(color_option);
      $("#add_to_cart_15").prop('href', $("#add_to_cart_<%= @item.id %>").prop('href') + "&color_id=" + color_option);
    }

  });
</script>


